// Enhanced Feelynx Application Data
const appData = {
  "creators": [
    {
      "id": 1,
      "name": "ArianaVex",
      "username": "@arianavex",
      "country": "United States",
      "age": 24,
      "tier": "Top 0.1%",
      "subscribers": "12.8k",
      "isLive": true,
      "viewers": 2400,
      "toyConnected": "Lovense Lush",
      "videoRate": 35,
      "voiceRate": 25,
      "specialties": ["Interactive Shows", "Gaming"],
      "earnings": "$5,240",
      "isNew": false,
      "status": "online"
    },
    {
      "id": 2,
      "name": "BlissfulBelle",
      "username": "@blissfulbelle",
      "country": "United Kingdom",
      "age": 28,
      "tier": "Premium",
      "subscribers": "11.5k",
      "isLive": false,
      "lastSeen": "2 hours ago",
      "toyConnected": null,
      "videoRate": 40,
      "voiceRate": 30,
      "specialties": ["Luxury Content", "ASMR"],
      "earnings": "$4,890",
      "isNew": false,
      "status": "online"
    },
    {
      "id": 3,
      "name": "MilaFox",
      "username": "@milafox",
      "country": "Germany",
      "age": 26,
      "tier": "VIP Creator",
      "subscribers": "15.3k",
      "isLive": true,
      "viewers": 1200,
      "toyConnected": "OhMiBod",
      "videoRate": 45,
      "voiceRate": 35,
      "specialties": ["Premium Shows", "Fetish"],
      "earnings": "$6,150",
      "isNew": false,
      "status": "online"
    },
    {
      "id": 4,
      "name": "SkylarNova",
      "username": "@skylarnova",
      "country": "Canada",
      "age": 22,
      "tier": "Rising Star",
      "subscribers": "8.2k",
      "isLive": true,
      "viewers": 890,
      "toyConnected": "Lovense Domi",
      "videoRate": 30,
      "voiceRate": 20,
      "specialties": ["Gaming", "Cosplay"],
      "earnings": "$3,420",
      "isNew": false,
      "status": "online"
    },
    {
      "id": 5,
      "name": "LunaRose",
      "username": "@lunarose",
      "country": "Australia",
      "age": 29,
      "tier": "Tech Expert",
      "subscribers": "9.1k",
      "isLive": false,
      "lastSeen": "1 hour ago",
      "toyConnected": "Lovense Edge",
      "videoRate": 38,
      "voiceRate": 28,
      "specialties": ["Tech Integration", "Interactive"],
      "earnings": "$4,200",
      "isNew": false,
      "status": "offline"
    },
    {
      "id": 6,
      "name": "ZaraWild",
      "username": "@zarawild",
      "country": "Brazil",
      "age": 25,
      "tier": "New Creator",
      "subscribers": "4.7k",
      "isLive": true,
      "viewers": 456,
      "toyConnected": "Lovense Lush",
      "videoRate": 25,
      "voiceRate": 18,
      "specialties": ["Dancing", "Interactive Fun"],
      "earnings": "$1,890",
      "isNew": true,
      "status": "online"
    }
  ],
  "tokenPacks": [
    {
      "name": "Micro Pack",
      "tokens": 20,
      "price": 1.99,
      "bonus": "Try it out!",
      "popular": false
    },
    {
      "name": "Small Pack",
      "tokens": 50,
      "price": 4.99,
      "bonus": "5% chance to double tokens",
      "popular": false
    },
    {
      "name": "Starter Pack",
      "tokens": 100,
      "price": 9.99,
      "bonus": "10% chance for 2√ó bonus",
      "popular": false
    },
    {
      "name": "Popular Pack",
      "tokens": 500,
      "price": 39.99,
      "bonus": "1 in 5 gets VIP access",
      "popular": true
    },
    {
      "name": "VIP Pack",
      "tokens": 1000,
      "price": 69.99,
      "bonus": "Guaranteed Mystery Reward",
      "popular": false
    },
    {
      "name": "High Roller Pack",
      "tokens": 2500,
      "price": 149.99,
      "bonus": "3 Mystery Boxes + Exclusive Badge",
      "popular": false
    }
  ],
  "groups": [
    {
      "id": 1,
      "name": "VIP Exclusive",
      "members": 89,
      "isPrivate": true,
      "announcements": [
        {
          "title": "Live Show Tonight!",
          "content": "Join ArianaVex and MilaFox for a special collaborative show at 9PM EST",
          "timestamp": "2 hours ago",
          "type": "live_show"
        }
      ],
      "activeShows": 1,
      "inviteExpiry": "23h 45m",
      "theme": "luxury"
    },
    {
      "id": 2,
      "name": "Gaming Queens",
      "members": 156,
      "isPrivate": true,
      "announcements": [
        {
          "title": "New Content Alert",
          "content": "SkylarNova just uploaded exclusive gaming cosplay content",
          "timestamp": "4 hours ago",
          "type": "content"
        }
      ],
      "activeShows": 0,
      "inviteExpiry": "12h 30m",
      "theme": "gaming"
    }
  ],
  "content": [
    {
      "id": 1,
      "title": "Exclusive Photo Set",
      "creator": "ArianaVex",
      "type": "photos",
      "tokenPrice": 50,
      "usdPrice": 4.99,
      "preview": "blurred",
      "owned": false,
      "sales": 342,
      "trending": true
    },
    {
      "id": 2,
      "title": "Premium Video Collection",
      "creator": "MilaFox",
      "type": "videos",
      "tokenPrice": 150,
      "usdPrice": 12.99,
      "preview": "blurred",
      "owned": false,
      "sales": 156,
      "trending": false
    },
    {
      "id": 3,
      "title": "Personal Voice Message",
      "creator": "BlissfulBelle",
      "type": "voice",
      "tokenPrice": 25,
      "usdPrice": 2.99,
      "preview": "blurred",
      "owned": false,
      "sales": 89,
      "trending": false
    },
    {
      "id": 4,
      "title": "Gaming Bundle Pack",
      "creator": "SkylarNova",
      "type": "bundles",
      "tokenPrice": 120,
      "usdPrice": 19.99,
      "preview": "blurred",
      "owned": false,
      "sales": 267,
      "trending": true
    }
  ],
  "countries": [
    "United States", "United Kingdom", "Canada", "Germany", "France", "Australia", "Japan", "Netherlands", "Sweden", "Spain", "Italy", "Brazil", "Mexico", "Argentina", "Colombia", "Portugal", "Russia", "India", "China", "South Korea", "Thailand", "Philippines", "Indonesia", "South Africa", "Nigeria", "Egypt", "Turkey", "Greece", "Belgium", "Switzerland", "Austria", "Denmark", "Norway", "Finland", "Ireland", "New Zealand", "Singapore", "Malaysia", "Vietnam", "Taiwan", "Hong Kong", "Israel", "Saudi Arabia", "UAE", "Qatar", "Kuwait", "Chile", "Peru", "Venezuela", "Ecuador", "Uruguay", "Paraguay", "Bolivia", "Costa Rica", "Panama", "Dominican Republic", "Puerto Rico", "Jamaica", "Trinidad and Tobago", "Bahamas", "Barbados"
  ],
  "specialties": ["Interactive Shows", "Gaming", "ASMR", "Luxury Content", "Cosplay", "Fetish", "Dancing", "Interactive Fun", "Tech Integration", "Premium Shows"],
  "tipAmounts": [1, 5, 10, 25, 50, 100],
  "ageRanges": ["18-24", "25-34", "35-44", "45+"]
};

// Global application state
let currentTab = 'explore';
let currentSection = 'featured';
let filteredCreators = [...appData.creators];
let selectedCreatorForTip = null;
let selectedTipAmount = 0;
let currentLanguage = 'en';
let eyeTrackingEnabled = true;

// Initialize the application - NO AGE VERIFICATION
document.addEventListener('DOMContentLoaded', function() {
    // Show main app immediately - no age verification
    initializeNavigation();
    initializeFilters();
    initializeModals();
    initializeLynxMascot();
    initializeLanguageSelector();
    populateContent();
    initializeGroupsFeatures();
    startRealTimeUpdates();
    
    // Show welcome animation on load
    setTimeout(() => {
        createWelcomeAnimation();
        animateStatCounters();
    }, 500);
    
    console.log('ü¶ä Feelynx platform initialized! Welcome to the hottest creators platform.');
});

// Enhanced Lynx Mascot with Eye Tracking
function initializeLynxMascot() {
    const leftEye = document.getElementById('leftEye');
    const rightEye = document.getElementById('rightEye');
    const navLogo = document.getElementById('navLogo');
    
    // Eye tracking mouse movement
    document.addEventListener('mousemove', function(e) {
        if (!eyeTrackingEnabled || !leftEye || !rightEye) return;
        
        const eyes = [leftEye, rightEye];
        eyes.forEach(eye => {
            const rect = eye.getBoundingClientRect();
            const eyeCenterX = rect.left + rect.width / 2;
            const eyeCenterY = rect.top + rect.height / 2;
            
            const angle = Math.atan2(e.clientY - eyeCenterY, e.clientX - eyeCenterX);
            const distance = Math.min(2, Math.hypot(e.clientX - eyeCenterX, e.clientY - eyeCenterY) / 50);
            
            const pupilX = Math.cos(angle) * distance;
            const pupilY = Math.sin(angle) * distance;
            
            eye.style.transform = `translate(${pupilX}px, ${pupilY}px)`;
        });
    });
    
    // Mascot hover effects
    if (navLogo) {
        navLogo.addEventListener('mouseenter', function() {
            winkAnimation();
        });
        
        navLogo.addEventListener('click', function() {
            playPurrSound();
            createSparkleTrail(this);
        });
    }
    
    // Random blink animation
    setInterval(randomBlink, 3000 + Math.random() * 2000);
}

function winkAnimation() {
    const leftEye = document.getElementById('leftEye');
    if (leftEye) {
        leftEye.style.transform = 'scaleY(0.1)';
        setTimeout(() => {
            leftEye.style.transform = 'scaleY(1)';
        }, 300);
    }
}

function randomBlink() {
    const eyes = document.querySelectorAll('.eye-small');
    eyes.forEach(eye => {
        eye.style.transform = 'scaleY(0.1)';
        setTimeout(() => {
            eye.style.transform = 'scaleY(1)';
        }, 150);
    });
}

function playPurrSound() {
    console.log('üê± *purr*');
    createSoundWave();
}

function createSoundWave() {
    const wave = document.createElement('div');
    wave.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        border: 2px solid #a259ff;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        animation: soundWave 1s ease-out forwards;
        pointer-events: none;
        z-index: 1002;
    `;
    
    const style = document.createElement('style');
    style.textContent = `
        @keyframes soundWave {
            to {
                width: 200px;
                height: 200px;
                opacity: 0;
            }
        }
    `;
    document.head.appendChild(style);
    document.body.appendChild(wave);
    
    setTimeout(() => {
        wave.remove();
        style.remove();
    }, 1000);
}

function createSparkleTrail(element) {
    for (let i = 0; i < 15; i++) {
        setTimeout(() => {
            const sparkle = document.createElement('div');
            sparkle.style.cssText = `
                position: absolute;
                width: 6px;
                height: 6px;
                background: linear-gradient(45deg, #a259ff, #f35369, #ffd700);
                border-radius: 50%;
                pointer-events: none;
                z-index: 1002;
                animation: sparkleTrail 1.5s ease-out forwards;
            `;
            
            const rect = element.getBoundingClientRect();
            sparkle.style.left = (rect.left + Math.random() * rect.width) + 'px';
            sparkle.style.top = (rect.top + Math.random() * rect.height) + 'px';
            
            document.body.appendChild(sparkle);
            
            setTimeout(() => sparkle.remove(), 1500);
        }, i * 100);
    }
}

// Language Selector
function initializeLanguageSelector() {
    const languageSelector = document.getElementById('languageSelector');
    if (languageSelector) {
        languageSelector.addEventListener('change', function() {
            translatePage(this.value);
        });
    }
}

function setCookie(name, value, days) {
    const date = new Date();
    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
    const expires = 'expires=' + date.toUTCString();
    document.cookie = name + '=' + value + ';' + expires + ';path=/';
}

function translatePage(lang) {
    const map = { 'en': '/en/en', 'es': '/en/es', 'pt': '/en/pt' };
    setCookie('googtrans', map[lang] || '/en/en', 1);
    currentLanguage = lang;
    translateInterface();
    location.reload();
}

function translateInterface() {
    const translations = {
        'en': {
            'explore': 'Explore',
            'creators': 'Creators',
            'content': 'Content',
            'calls': 'Calls',
            'tokens': 'Tokens',
            'groups': 'Groups',
            'dashboard': 'Dashboard'
        },
        'es': {
            'explore': 'Explorar',
            'creators': 'Creadores',
            'content': 'Contenido',
            'calls': 'Llamadas',
            'tokens': 'Tokens',
            'groups': 'Grupos',
            'dashboard': 'Panel'
        },
        'pt': {
            'explore': 'Explorar',
            'creators': 'Criadores',
            'content': 'Conte√∫do',
            'calls': 'Chamadas',
            'tokens': 'Tokens',
            'groups': 'Grupos',
            'dashboard': 'Painel'
        }
    };
    
    const currentTranslations = translations[currentLanguage];
    if (currentTranslations) {
        document.querySelectorAll('.tab-text').forEach((element, index) => {
            const keys = Object.keys(currentTranslations);
            if (keys[index]) {
                element.textContent = currentTranslations[keys[index]];
            }
        });
    }
}

// Animate Statistics Counters
function animateStatCounters() {
    const statValues = document.querySelectorAll('.stat-value');
    statValues.forEach(stat => {
        const countData = stat.dataset.count;
        if (countData) {
            const target = parseInt(countData);
            animateCounter(stat, target);
        }
    });
}

function animateCounter(element, target) {
    let current = 0;
    const increment = target / 100;
    const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
            current = target;
            clearInterval(timer);
        }
        
        if (target >= 1000000) {
            element.textContent = '$' + (current / 1000000).toFixed(1) + 'M+';
        } else if (target >= 1000) {
            element.textContent = (current / 1000).toFixed(0) + 'k+';
        } else {
            element.textContent = Math.floor(current).toLocaleString() + '+';
        }
    }, 20);
}

// Enhanced Navigation System
function initializeNavigation() {
    const navTabs = document.querySelectorAll('.nav-tab');
    const tabContents = document.querySelectorAll('.tab-content');
    const sectionTabs = document.querySelectorAll('.section-tab');
    
    navTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const targetTab = this.dataset.tab;
            
            // Animated tab transition
            navTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === targetTab) {
                    setTimeout(() => content.classList.add('active'), 100);
                }
            });
            
            currentTab = targetTab;
            
            // Load tab-specific content
            loadTabContent(targetTab);
        });
    });
    
    // Section navigation for Explore tab
    sectionTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const targetSection = this.dataset.section;
            
            sectionTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            document.querySelectorAll('.creator-section').forEach(section => {
                section.classList.remove('active');
                if (section.id === targetSection) {
                    section.classList.add('active');
                }
            });
            
            currentSection = targetSection;
            loadSectionContent(targetSection);
        });
    });
}

function loadTabContent(tab) {
    switch(tab) {
        case 'explore':
            renderExploreContent();
            break;
        case 'creators':
            renderCreatorsContent();
            break;
        case 'content':
            renderContentGrid();
            break;
        case 'calls':
            renderCallCreators();
            break;
        case 'tokens':
            renderTokenPacks();
            break;
        case 'groups':
            renderGroupsContent();
            break;
        case 'dashboard':
            renderDashboard();
            break;
    }
}

function loadSectionContent(section) {
    let creators = [];
    switch(section) {
        case 'featured':
            creators = appData.creators.filter(c => c.tier.includes('Top') || c.tier.includes('VIP')).slice(0, 6);
            break;
        case 'today':
            creators = appData.creators.filter(c => c.isLive).slice(0, 6);
            break;
        case 'weekly':
            creators = appData.creators
                .sort((a, b) => {
                    const aSubs = parseFloat(a.subscribers.replace('k', '')) * 1000;
                    const bSubs = parseFloat(b.subscribers.replace('k', '')) * 1000;
                    return bSubs - aSubs;
                })
                .slice(0, 6);
            break;
        case 'alltime':
            creators = appData.creators.sort((a, b) => parseFloat(b.earnings.replace('$', '').replace(',', '')) - parseFloat(a.earnings.replace('$', '').replace(',', ''))).slice(0, 6);
            break;
    }
    
    const container = document.getElementById(section + 'Creators');
    if (container) {
        container.innerHTML = renderCreatorCards(creators);
    }
}

// Advanced Search and Filtering
function initializeFilters() {
    const countryFilter = document.getElementById('countryFilter');
    const ageFilter = document.getElementById('ageFilter');
    const specialtyFilter = document.getElementById('specialtyFilter');
    const creatorSearch = document.getElementById('creatorSearch');
    const onlineOnlyFilter = document.getElementById('onlineOnlyFilter');
    const toyConnectedFilter = document.getElementById('toyConnectedFilter');
    
    // Populate filters
    if (countryFilter) {
        appData.countries.forEach(country => {
            const option = document.createElement('option');
            option.value = country;
            option.textContent = country;
            countryFilter.appendChild(option);
        });
    }
    
    if (specialtyFilter) {
        appData.specialties.forEach(specialty => {
            const option = document.createElement('option');
            option.value = specialty;
            option.textContent = specialty;
            specialtyFilter.appendChild(option);
        });
    }
    
    // Add event listeners
    const filters = [creatorSearch, countryFilter, ageFilter, specialtyFilter, onlineOnlyFilter, toyConnectedFilter];
    filters.forEach(filter => {
        if (filter) {
            filter.addEventListener('input', debounce(filterCreators, 300));
            filter.addEventListener('change', filterCreators);
        }
    });
    
    // Advanced autocomplete
    if (creatorSearch) {
        initializeAdvancedAutocomplete(creatorSearch);
    }
}

function initializeAdvancedAutocomplete(searchInput) {
    let autocompleteList = null;
    
    searchInput.addEventListener('input', function() {
        const value = this.value.toLowerCase();
        
        if (autocompleteList) {
            autocompleteList.remove();
        }
        
        if (value.length < 2) return;
        
        const matches = appData.creators.filter(creator => 
            creator.username.toLowerCase().includes(value) ||
            creator.name.toLowerCase().includes(value) ||
            creator.country.toLowerCase().includes(value) ||
            creator.specialties.some(s => s.toLowerCase().includes(value))
        ).slice(0, 8);
        
        if (matches.length > 0) {
            autocompleteList = document.createElement('div');
            autocompleteList.className = 'autocomplete-list';
            autocompleteList.style.cssText = `
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--color-surface);
                border: 2px solid var(--feelynx-purple);
                border-radius: var(--radius-lg);
                box-shadow: var(--feelynx-shadow);
                z-index: 1000;
                max-height: 300px;
                overflow-y: auto;
            `;
            
            matches.forEach(creator => {
                const item = document.createElement('div');
                item.className = 'autocomplete-item';
                item.style.cssText = `
                    padding: var(--space-12);
                    cursor: pointer;
                    border-bottom: 1px solid var(--color-border);
                    transition: background var(--duration-fast) var(--ease-standard);
                    display: flex;
                    align-items: center;
                    gap: var(--space-8);
                `;
                
                item.innerHTML = `
                    <div class="mini-avatar" style="
                        width: 32px;
                        height: 32px;
                        border-radius: 50%;
                        background: var(--feelynx-gradient);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-size: var(--font-size-sm);
                        font-weight: bold;
                    ">${creator.name.charAt(0)}</div>
                    <div>
                        <div style="font-weight: bold;">${creator.username}</div>
                        <div style="font-size: var(--font-size-xs); color: var(--color-text-secondary);">
                            ${creator.name} ‚Ä¢ ${creator.country}
                        </div>
                    </div>
                    ${creator.isLive ? '<span style="color: #ff4757; font-size: var(--font-size-xs);">üî¥ LIVE</span>' : ''}
                `;
                
                item.addEventListener('mouseenter', function() {
                    this.style.background = 'var(--color-secondary)';
                });
                
                item.addEventListener('mouseleave', function() {
                    this.style.background = 'transparent';
                });
                
                item.addEventListener('click', () => {
                    searchInput.value = creator.username;
                    autocompleteList.remove();
                    filterCreators();
                });
                
                autocompleteList.appendChild(item);
            });
            
            searchInput.parentElement.style.position = 'relative';
            searchInput.parentElement.appendChild(autocompleteList);
        }
    });
    
    document.addEventListener('click', function(e) {
        if (autocompleteList && !searchInput.contains(e.target) && !autocompleteList.contains(e.target)) {
            autocompleteList.remove();
        }
    });
}

function filterCreators() {
    const search = document.getElementById('creatorSearch')?.value.toLowerCase() || '';
    const country = document.getElementById('countryFilter')?.value || '';
    const ageRange = document.getElementById('ageFilter')?.value || '';
    const specialty = document.getElementById('specialtyFilter')?.value || '';
    const onlineOnly = document.getElementById('onlineOnlyFilter')?.checked || false;
    const toyConnected = document.getElementById('toyConnectedFilter')?.checked || false;
    
    filteredCreators = appData.creators.filter(creator => {
        // Search filter
        if (search && !creator.username.toLowerCase().includes(search) && 
            !creator.name.toLowerCase().includes(search) &&
            !creator.country.toLowerCase().includes(search) &&
            !creator.specialties.some(s => s.toLowerCase().includes(search))) {
            return false;
        }
        
        // Country filter
        if (country && creator.country !== country) {
            return false;
        }
        
        // Age filter
        if (ageRange) {
            const [minAge, maxAge] = ageRange.split('-').map(age => parseInt(age.replace('+', '')));
            if (maxAge) {
                if (creator.age < minAge || creator.age > maxAge) return false;
            } else if (creator.age < minAge) {
                return false;
            }
        }
        
        // Specialty filter
        if (specialty && !creator.specialties.includes(specialty)) {
            return false;
        }
        
        // Online only filter
        if (onlineOnly && creator.status !== 'online') {
            return false;
        }
        
        // Toy connected filter
        if (toyConnected && !creator.toyConnected) {
            return false;
        }
        
        return true;
    });
    
    renderAllCreators();
}

// Content Rendering Functions
function populateContent() {
    renderExploreContent();
    renderCreatorsContent();
    renderContentGrid();
    renderCallCreators();
    renderTokenPacks();
    renderGroupsContent();
    renderDashboard();
}

function renderExploreContent() {
    loadSectionContent('featured');
    renderLiveCarousel('liveCarousel');
}

function renderCreatorsContent() {
    renderLiveCarousel('liveCarouselCreators');
    renderAllCreators();
}

function renderLiveCarousel(containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    const liveCreators = appData.creators.filter(c => c.isLive);
    
    container.innerHTML = liveCreators.map(creator => `
        <div class="live-creator-card" onclick="openTipModal('${creator.username}')">
            <div class="live-badge">LIVE</div>
            <div class="creator-preview">
                ${creator.name.charAt(0)}
            </div>
            <div class="creator-info">
                <div class="creator-name">${creator.name}</div>
                <div class="creator-username">${creator.username}</div>
                <div class="creator-stats">
                    <div class="viewer-count">üë• ${formatNumber(creator.viewers)} viewers</div>
                    <div class="tier-badge">${creator.tier}</div>
                    ${creator.toyConnected ? `<div class="toy-indicator">üéÆ ${creator.toyConnected}</div>` : ''}
                </div>
                <div class="creator-actions">
                    <button class="btn btn--tip btn--sm" onclick="event.stopPropagation(); openTipModal('${creator.username}')">üí∏ Tip</button>
                    <button class="btn btn--outline btn--sm">üëÅÔ∏è Watch</button>
                </div>
            </div>
        </div>
    `).join('');
}

function renderAllCreators() {
    const container = document.getElementById('allCreators');
    if (!container) return;
    
    container.innerHTML = renderCreatorCards(filteredCreators);
}

function renderCreatorCards(creators) {
    return creators.map(creator => `
        <div class="creator-card" onclick="openCreatorProfile('${creator.username}')">
            <div class="creator-header">
                <div class="creator-avatar">
                    ${creator.name.charAt(0)}
                    <div class="status-indicator ${creator.status}"></div>
                    ${creator.isNew ? '<div class="new-badge">NEW</div>' : ''}
                    ${creator.toyConnected ? '<div class="toy-badge">üéÆ</div>' : ''}
                </div>
                <div class="creator-details">
                    <div class="creator-name">${creator.name}</div>
                    <div class="creator-username">${creator.username}</div>
                    <div class="creator-stats">
                        <span>üë• ${creator.subscribers} subscribers</span>
                        <span class="tier-badge">${creator.tier}</span>
                    </div>
                    <div class="creator-specialties">
                        ${creator.specialties.slice(0, 2).map(s => `<span class="specialty-tag">${s}</span>`).join('')}
                    </div>
                </div>
            </div>
            <div class="creator-actions">
                <button class="btn btn--tip" onclick="event.stopPropagation(); openTipModal('${creator.username}')">üí∏ Tip</button>
                <button class="btn btn--outline" onclick="event.stopPropagation(); openPrivateMessage('${creator.username}')">üí¨ Message</button>
            </div>
        </div>
    `).join('');
}

function renderContentGrid() {
    const container = document.getElementById('contentGrid');
    if (!container) return;
    
    container.innerHTML = appData.content.map(content => `
        <div class="content-card" onclick="viewContent('${content.id}')">
            <div class="content-preview ${content.preview}">
                ${getContentIcon(content.type)}
                ${content.trending ? '<div class="trending-badge">üî• Trending</div>' : ''}
                ${content.sales > 200 ? '<div class="selling-fast">‚ö° Selling Fast</div>' : ''}
            </div>
            <div class="content-info">
                <h4>${content.title}</h4>
                <p>by ${content.creator}</p>
                <div class="content-pricing">
                    <span class="price token-price">${content.tokenPrice} tokens</span>
                    <span class="price usd-price">$${content.usdPrice}</span>
                </div>
                <div class="content-stats">
                    <span>üìä ${content.sales} sales</span>
                </div>
            </div>
        </div>
    `).join('');
    
    // Initialize content type filters
    initializeContentFilters();
}

function initializeContentFilters() {
    const filters = document.querySelectorAll('.content-filter');
    filters.forEach(filter => {
        filter.addEventListener('click', function() {
            filters.forEach(f => f.classList.remove('active'));
            this.classList.add('active');
            
            const type = this.dataset.type;
            filterContentByType(type);
        });
    });
}

function filterContentByType(type) {
    const cards = document.querySelectorAll('.content-card');
    cards.forEach(card => {
        if (type === 'all') {
            card.style.display = 'block';
        } else {
            const contentId = card.onclick.toString().match(/'(\d+)'/)[1];
            const content = appData.content.find(c => c.id == contentId);
            card.style.display = content && content.type === type ? 'block' : 'none';
        }
    });
}

function getContentIcon(type) {
    const icons = {
        'photos': 'üì∏',
        'videos': 'üé•',
        'voice': 'üéµ',
        'bundles': 'üì¶'
    };
    return icons[type] || 'üìÑ';
}

function renderCallCreators() {
    const container = document.getElementById('callCreators');
    if (!container) return;
    
    const availableCreators = appData.creators.filter(c => c.status === 'online');
    
    container.innerHTML = availableCreators.map(creator => `
        <div class="call-creator-card">
            <div class="creator-header">
                <div class="creator-avatar">
                    ${creator.name.charAt(0)}
                    <div class="status-indicator online"></div>
                </div>
                <div class="creator-details">
                    <div class="creator-name">${creator.name}</div>
                    <div class="creator-username">${creator.username}</div>
                    <div class="creator-specialties">
                        ${creator.specialties.slice(0, 2).map(s => `<span class="specialty-tag">${s}</span>`).join('')}
                    </div>
                </div>
            </div>
            <div class="call-rates">
                <div class="rate-option">
                    <span class="rate-type">üìπ Video</span>
                    <span class="call-rate">${creator.videoRate} tokens/min</span>
                </div>
                <div class="rate-option">
                    <span class="rate-type">üéµ Voice</span>
                    <span class="call-rate">${creator.voiceRate} tokens/min</span>
                </div>
            </div>
            <div class="call-actions">
                <button class="btn btn--primary btn--full-width" onclick="initiateCall('${creator.username}', 'video')">
                    üìπ Video Call
                </button>
                <button class="btn btn--outline btn--full-width" onclick="initiateCall('${creator.username}', 'voice')">
                    üéµ Voice Call
                </button>
            </div>
            ${creator.toyConnected ? `
                <div class="toy-sync-dashboard">
                    <h5>üéÆ Toy Sync Dashboard</h5>
                    <div class="intensity-visualizer">
                        <div class="intensity-bar" style="width: ${Math.random() * 80 + 20}%"></div>
                    </div>
                    <span class="intensity-label">Real-time intensity</span>
                </div>
            ` : ''}
        </div>
    `).join('');
}

function renderTokenPacks() {
    const container = document.getElementById('tokenPacks');
    if (!container) return;
    
    container.innerHTML = appData.tokenPacks.map((pack, index) => `
        <div class="token-pack ${pack.popular ? 'popular' : ''}" onclick="purchaseTokens('${pack.name}', ${pack.price}, ${pack.tokens})">
            <div class="token-amount">${pack.tokens}</div>
            <div class="token-currency">TOKENS</div>
            <div class="token-price">$${pack.price}</div>
            <div class="token-bonus">${pack.bonus}</div>
            <div class="mystery-meter">
                <div class="meter-fill" style="width: ${Math.random() * 100}%"></div>
                <span class="meter-label">Mystery Bonus</span>
            </div>
            <button class="btn btn--primary btn--full-width purchase-btn">
                üíé Purchase Tokens
            </button>
        </div>
    `).join('');
}

function renderGroupsContent() {
    renderGroupAnnouncements();
    renderGroupsGrid();
}

function renderGroupAnnouncements() {
    const container = document.getElementById('announcementsGrid');
    if (!container) return;
    
    const userGroups = appData.groups.filter(g => g.isPrivate); // User's private groups only
    const allAnnouncements = userGroups.flatMap(group => 
        group.announcements.map(announcement => ({
            ...announcement,
            groupName: group.name,
            groupId: group.id
        }))
    );
    
    container.innerHTML = allAnnouncements.map(announcement => `
        <div class="announcement-card">
            <div class="announcement-header">
                <div class="group-info">
                    <span class="group-name">${announcement.groupName}</span>
                    <span class="announcement-type">${getAnnouncementIcon(announcement.type)} ${announcement.type}</span>
                </div>
                <span class="announcement-time">${announcement.timestamp}</span>
            </div>
            <div class="announcement-content">
                <h4>${announcement.title}</h4>
                <p>${announcement.content}</p>
            </div>
            ${announcement.type === 'live_show' ? `
                <div class="announcement-actions">
                    <button class="btn btn--primary btn--sm">Join Live Show</button>
                </div>
            ` : ''}
        </div>
    `).join('');
}

function renderGroupsGrid() {
    const container = document.getElementById('groupsGrid');
    if (!container) return;
    
    container.innerHTML = appData.groups.map(group => `
        <div class="group-card">
            <div class="group-header">
                <div class="group-name">${group.name}</div>
                <div class="group-privacy">${group.isPrivate ? 'üîí Private' : 'üåç Public'}</div>
            </div>
            <div class="group-stats">
                <div class="stat">
                    <span>üë• ${group.members} members</span>
                </div>
                <div class="stat">
                    <span>üé≠ ${group.activeShows} live shows</span>
                </div>
                ${group.isPrivate ? `
                    <div class="invite-timer">
                        <span>‚è∞ Invite expires: ${group.inviteExpiry}</span>
                    </div>
                ` : ''}
            </div>
            <div class="group-theme theme-${group.theme}">
                ${getThemeIcon(group.theme)} ${group.theme}
            </div>
            <div class="group-actions">
                <button class="btn btn--primary btn--full-width" onclick="joinGroup('${group.id}')">
                    View Group
                </button>
                ${group.isPrivate ? `
                    <button class="btn btn--outline btn--full-width" onclick="generateInviteLink('${group.id}')">
                        üìé Generate Invite Link
                    </button>
                ` : ''}
            </div>
        </div>
    `).join('');
}

function getAnnouncementIcon(type) {
    const icons = {
        'live_show': 'üé≠',
        'content': 'üì∏',
        'announcement': 'üì¢'
    };
    return icons[type] || 'üì¢';
}

function getThemeIcon(theme) {
    const icons = {
        'gaming': 'üéÆ',
        'luxury': 'üíé',
        'general': 'üë•',
        'interactive': '‚ö°'
    };
    return icons[theme] || 'üåü';
}

function renderDashboard() {
    render3DAnalytics();
    renderTrophyRoom();
    setupGeoBlocking();
}

function render3DAnalytics() {
    // Already rendered in HTML, add dynamic updates
    const bars = document.querySelectorAll('.bar');
    bars.forEach((bar, index) => {
        setTimeout(() => {
            bar.style.height = bar.style.height;
        }, index * 200);
    });
    
    const metrics = document.querySelectorAll('.metric-fill');
    metrics.forEach((metric, index) => {
        setTimeout(() => {
            metric.style.width = metric.style.width;
        }, index * 300);
    });
}

function renderTrophyRoom() {
    const trophies = document.querySelectorAll('.trophy-3d');
    trophies.forEach((trophy, index) => {
        trophy.addEventListener('click', function() {
            if (this.classList.contains('active')) {
                showAchievementDetails(this);
            } else {
                showLockedAchievement(this);
            }
        });
    });
}

// Enhanced Groups Features
function initializeGroupsFeatures() {
    const createGroupBtn = document.getElementById('createGroupBtn');
    const createGroup = document.getElementById('createGroup');
    
    if (createGroupBtn) {
        createGroupBtn.addEventListener('click', function() {
            document.getElementById('groupModal').classList.add('active');
        });
    }
    
    if (createGroup) {
        createGroup.addEventListener('click', createNewGroup);
    }
}

// Modal System
function initializeModals() {
    const tipModal = document.getElementById('tipModal');
    const successModal = document.getElementById('successModal');
    const groupModal = document.getElementById('groupModal');
    const modalCloses = document.querySelectorAll('.modal-close');
    const closeSuccess = document.getElementById('closeSuccess');
    
    modalCloses.forEach(close => {
        close.addEventListener('click', function() {
            this.closest('.modal').classList.remove('active');
        });
    });
    
    if (closeSuccess) {
        closeSuccess.addEventListener('click', function() {
            successModal.classList.remove('active');
        });
    }
    
    // Setup tip system
    setupTipSystem();
    
    // Close modals on backdrop click
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('active');
            }
        });
    });
}

// Enhanced USD Tipping System
function setupTipSystem() {
    const container = document.getElementById('tipAmounts');
    if (!container) return;
    
    container.innerHTML = appData.tipAmounts.map(amount => `
        <div class="tip-amount" onclick="selectTipAmount(${amount})">$${amount}</div>
    `).join('');
    
    const confirmTip = document.getElementById('confirmTip');
    const customTipAmount = document.getElementById('customTipAmount');
    
    if (confirmTip) {
        confirmTip.addEventListener('click', processTip);
    }
    
    if (customTipAmount) {
        customTipAmount.addEventListener('input', handleCustomTip);
    }
}

function openTipModal(username) {
    selectedCreatorForTip = username;
    const modal = document.getElementById('tipModal');
    modal.classList.add('active');
    
    // Reset state
    selectedTipAmount = 0;
    document.getElementById('tipConfirmation').classList.remove('active');
    document.getElementById('customTipAmount').value = '';
    document.querySelectorAll('.tip-amount').forEach(el => el.classList.remove('selected'));
}

function selectTipAmount(amount) {
    selectedTipAmount = amount;
    
    // Update UI
    document.querySelectorAll('.tip-amount').forEach(el => el.classList.remove('selected'));
    event.target.classList.add('selected');
    document.getElementById('customTipAmount').value = '';
    
    showTipConfirmation();
}

function handleCustomTip() {
    const customAmount = parseInt(document.getElementById('customTipAmount').value);
    
    if (customAmount && customAmount > 0) {
        selectedTipAmount = customAmount;
        document.querySelectorAll('.tip-amount').forEach(el => el.classList.remove('selected'));
        showTipConfirmation();
    } else {
        document.getElementById('tipConfirmation').classList.remove('active');
    }
}

function showTipConfirmation() {
    const confirmation = document.getElementById('tipConfirmation');
    const confirmText = document.getElementById('tipConfirmText');
    
    const creatorShare = (selectedTipAmount * 0.94).toFixed(2);
    const platformFee = (selectedTipAmount * 0.06).toFixed(2);
    
    confirmText.innerHTML = `
        <div class="tip-breakdown">
            <div class="tip-line">
                <span>Tip Amount:</span>
                <span class="amount">$${selectedTipAmount}.00</span>
            </div>
            <div class="tip-line">
                <span>Creator receives (94%):</span>
                <span class="amount creator-amount">$${creatorShare}</span>
            </div>
            <div class="tip-line small">
                <span>Platform fee (6%):</span>
                <span class="amount">$${platformFee}</span>
            </div>
        </div>
        <p class="tip-notice">This will appear as a direct credit card charge to ${selectedCreatorForTip}</p>
    `;
    
    confirmation.classList.add('active');
}

function processTip() {
    if (!selectedTipAmount || !selectedCreatorForTip) return;
    
    const tipModal = document.getElementById('tipModal');
    tipModal.classList.remove('active');
    
    // Simulate payment processing
    showLoadingAnimation();
    
    setTimeout(() => {
        createConfettiAnimation();
        createSparkleEffect(document.body);
        
        setTimeout(() => {
            const creatorShare = (selectedTipAmount * 0.94).toFixed(2);
            showSuccessModal(
                'üéâ Tip Sent Successfully!', 
                `Your $${selectedTipAmount}.00 tip has been sent to ${selectedCreatorForTip}!\n\nThe creator receives $${creatorShare} (94% payout)\nThank you for supporting our creators! üíñ`
            );
        }, 1000);
    }, 2000);
}

// Geo-blocking System
function setupGeoBlocking() {
    const select = document.getElementById('geoBlockSelect');
    const saveButton = document.getElementById('saveGeoBlocking');
    
    if (!select || !saveButton) return;
    
    // Populate countries
    appData.countries.forEach(country => {
        const option = document.createElement('option');
        option.value = country;
        option.textContent = country;
        select.appendChild(option);
    });
    
    saveButton.addEventListener('click', function() {
        const selectedCountries = Array.from(select.selectedOptions).map(option => option.value);
        
        createSparkleEffect(this);
        showSuccessModal(
            'üåç Geo-blocking Updated!',
            `Your content is now blocked in ${selectedCountries.length} selected countries.\n\nChanges take effect immediately for all your content.`
        );
    });
}

// Real-time Updates
function startRealTimeUpdates() {
    // Update viewer counts
    setInterval(() => {
        appData.creators.forEach(creator => {
            if (creator.isLive) {
                const variation = Math.floor(Math.random() * 100) - 50;
                creator.viewers = Math.max(0, creator.viewers + variation);
            }
        });
        updateViewerCounts();
    }, 10000);
    
    // Update live status occasionally
    setInterval(() => {
        const randomCreator = appData.creators[Math.floor(Math.random() * appData.creators.length)];
        if (Math.random() < 0.1) { // 10% chance
            randomCreator.isLive = !randomCreator.isLive;
            if (randomCreator.isLive) {
                randomCreator.viewers = Math.floor(Math.random() * 1000) + 100;
            }
        }
    }, 30000);
    
    // Update group invite expiry timers
    setInterval(updateGroupTimers, 60000); // Update every minute
}

function updateViewerCounts() {
    const viewerElements = document.querySelectorAll('.viewer-count');
    viewerElements.forEach(element => {
        const username = element.closest('[onclick]')?.onclick.toString().match(/@\w+/)?.[0];
        if (username) {
            const creator = appData.creators.find(c => c.username === username);
            if (creator && creator.isLive) {
                element.textContent = `üë• ${formatNumber(creator.viewers)} viewers`;
            }
        }
    });
}

function updateGroupTimers() {
    appData.groups.forEach(group => {
        if (group.inviteExpiry && group.inviteExpiry !== 'EXPIRED') {
            // Simulate countdown - in real app this would be calculated from actual expiry time
            const parts = group.inviteExpiry.split('h ');
            let hours = parseInt(parts[0]);
            let minutes = parseInt(parts[1].replace('m', ''));
            
            minutes--;
            if (minutes < 0) {
                hours--;
                minutes = 59;
            }
            
            if (hours < 0) {
                group.inviteExpiry = 'EXPIRED';
            } else {
                group.inviteExpiry = `${hours}h ${minutes}m`;
            }
        }
    });
    
    // Re-render groups if on groups tab
    if (currentTab === 'groups') {
        renderGroupsGrid();
    }
}

// Utility Functions
function formatNumber(num) {
    if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'k';
    }
    return num.toString();
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

function showSuccessModal(title, message) {
    const modal = document.getElementById('successModal');
    const titleEl = document.getElementById('successTitle');
    const messageEl = document.getElementById('successMessage');
    
    titleEl.textContent = title;
    messageEl.innerHTML = message.replace(/\n/g, '<br>');
    modal.classList.add('active');
    
    // Add sparkles to success modal
    createSuccessSparkles();
}

function createSuccessSparkles() {
    const sparklesContainer = document.getElementById('successSparkles');
    if (!sparklesContainer) return;
    
    for (let i = 0; i < 20; i++) {
        setTimeout(() => {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.top = Math.random() * 100 + '%';
            sparkle.style.animationDelay = Math.random() * 1 + 's';
            sparklesContainer.appendChild(sparkle);
            
            setTimeout(() => sparkle.remove(), 2000);
        }, i * 100);
    }
}

function createWelcomeAnimation() {
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.top = '100%';
            confetti.style.background = ['#a259ff', '#f35369', '#ffd700', '#00ff88'][Math.floor(Math.random() * 4)];
            document.body.appendChild(confetti);
            
            setTimeout(() => confetti.remove(), 3000);
        }, i * 50);
    }
}

function createConfettiAnimation() {
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.top = '100%';
            confetti.style.background = ['#a259ff', '#f35369', '#ffd700'][Math.floor(Math.random() * 3)];
            document.body.appendChild(confetti);
            
            setTimeout(() => confetti.remove(), 3000);
        }, i * 100);
    }
}

function createSparkleEffect(element) {
    const rect = element.getBoundingClientRect();
    for (let i = 0; i < 10; i++) {
        setTimeout(() => {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.position = 'fixed';
            sparkle.style.left = (rect.left + Math.random() * rect.width) + 'px';
            sparkle.style.top = (rect.top + Math.random() * rect.height) + 'px';
            sparkle.style.zIndex = '1002';
            document.body.appendChild(sparkle);
            
            setTimeout(() => sparkle.remove(), 1000);
        }, i * 100);
    }
}

function showLoadingAnimation() {
    const loader = document.createElement('div');
    loader.innerHTML = 'üíé Processing payment...';
    loader.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--feelynx-gradient);
        color: white;
        padding: var(--space-16) var(--space-24);
        border-radius: var(--radius-lg);
        z-index: 1002;
        animation: pulse 1s infinite;
        font-weight: bold;
    `;
    document.body.appendChild(loader);
    
    setTimeout(() => loader.remove(), 2000);
}

// Action Functions
function purchaseTokens(packName, price, tokens) {
    const pack = appData.tokenPacks.find(p => p.name === packName);
    if (!pack) return;
    
    createSparkleEffect(event.target.closest('.token-pack'));
    
    // Spin-to-reveal animation
    const tokenPack = event.target.closest('.token-pack');
    tokenPack.style.transform = 'rotateY(360deg)';
    
    setTimeout(() => {
        createConfettiAnimation();
        
        setTimeout(() => {
            showSuccessModal(
                'üéâ Tokens Purchased!',
                `You've successfully purchased ${tokens} tokens for $${price}!\n\nüéÅ ${pack.bonus}\n\nTokens have been added to your account!`
            );
        }, 500);
    }, 1000);
}

function initiateCall(username, type) {
    const creator = appData.creators.find(c => c.username === username);
    if (!creator) return;
    
    const rate = type === 'video' ? creator.videoRate : creator.voiceRate;
    const callType = type === 'video' ? 'üìπ Video' : 'üéµ Voice';
    
    showSuccessModal(
        `${callType} Call Requested!`,
        `Your ${type} call request with ${username} has been sent.\n\nRate: ${rate} tokens/min\nThey will respond within 5 minutes.`
    );
}

function viewContent(contentId) {
    const content = appData.content.find(c => c.id == contentId);
    if (!content) return;
    
    createCustomModal(`${getContentIcon(content.type)} ${content.title}`, `
        <div class="content-preview-modal">
            <p><strong>Creator:</strong> ${content.creator}</p>
            <div class="pricing-options">
                <div class="price-option">
                    <span class="price-label">Token Price:</span>
                    <span class="price-value">${content.tokenPrice} tokens</span>
                </div>
                <div class="price-option">
                    <span class="price-label">USD Price:</span>
                    <span class="price-value">$${content.usdPrice}</span>
                </div>
            </div>
            <p class="sales-info">üìä ${content.sales} people have purchased this content</p>
            <div class="purchase-actions">
                <button class="btn btn--primary" onclick="purchaseContent('${contentId}', 'token')">
                    üíé Buy with Tokens
                </button>
                <button class="btn btn--outline" onclick="purchaseContent('${contentId}', 'usd')">
                    üí≥ Buy with USD
                </button>
            </div>
        </div>
    `);
}

function purchaseContent(contentId, method) {
    const content = appData.content.find(c => c.id == contentId);
    if (!content) return;
    
    const price = method === 'token' ? `${content.tokenPrice} tokens` : `$${content.usdPrice}`;
    
    createSparkleEffect(document.body);
    showSuccessModal(
        'üõí Content Purchased!',
        `You've successfully purchased "${content.title}" for ${price}!\n\nContent is now available in your library.`
    );
}

function joinGroup(groupId) {
    const group = appData.groups.find(g => g.id == groupId);
    if (!group) return;
    
    createSparkleEffect(event.target);
    showSuccessModal(
        'üë• Group Access!',
        `Welcome to "${group.name}"!\n\nYou can now participate in group activities, exclusive content, and multi-creator live shows.`
    );
}

function generateInviteLink(groupId) {
    const group = appData.groups.find(g => g.id == groupId);
    if (!group) return;
    
    const inviteLink = `https://feelynx.com/invite/${groupId}/${Date.now()}`;
    
    navigator.clipboard.writeText(inviteLink).then(() => {
        showSuccessModal(
            'üìé Invite Link Generated!',
            `Invite link copied to clipboard!\n\nLink: ${inviteLink}\n\nExpires in: ${group.inviteExpiry}`
        );
    }).catch(() => {
        showSuccessModal(
            'üìé Invite Link Generated!',
            `Invite link: ${inviteLink}\n\nExpires in: ${group.inviteExpiry}\n\nPlease copy manually.`
        );
    });
}

function createNewGroup() {
    const groupName = document.getElementById('groupName').value;
    const groupTheme = document.getElementById('groupTheme').value;
    
    if (!groupName.trim()) {
        alert('Please enter a group name');
        return;
    }
    
    document.getElementById('groupModal').classList.remove('active');
    
    createConfettiAnimation();
    showSuccessModal(
        'üéâ Group Created!',
        `"${groupName}" has been created successfully!\n\nTheme: ${getThemeIcon(groupTheme)} ${groupTheme}\nInvite link expires in 24 hours\nSupports multi-creator live shows!`
    );
    
    // Add to groups data
    const newGroup = {
        id: appData.groups.length + 1,
        name: groupName,
        members: 1,
        isPrivate: true,
        announcements: [],
        activeShows: 0,
        inviteExpiry: '23h 59m',
        theme: groupTheme
    };
    appData.groups.push(newGroup);
    
    if (currentTab === 'groups') {
        renderGroupsContent();
    }
}

function openCreatorProfile(username) {
    const creator = appData.creators.find(c => c.username === username);
    if (!creator) return;
    
    createCustomModal(`${creator.name} ${creator.username}`, `
        <div class="creator-profile">
            <div class="profile-header">
                <div class="profile-avatar">${creator.name.charAt(0)}</div>
                <div class="profile-info">
                    <h3>${creator.name}</h3>
                    <p>${creator.username}</p>
                    <p>üìç ${creator.country} ‚Ä¢ üéÇ ${creator.age} years old</p>
                    <p class="tier-info">üèÜ ${creator.tier}</p>
                </div>
            </div>
            <div class="profile-stats">
                <div class="stat">
                    <span class="stat-value">${creator.subscribers}</span>
                    <span class="stat-label">Subscribers</span>
                </div>
                <div class="stat">
                    <span class="stat-value">${creator.earnings}</span>
                    <span class="stat-label">Total Earned</span>
                </div>
                ${creator.isLive ? `
                    <div class="stat">
                        <span class="stat-value live">${formatNumber(creator.viewers)}</span>
                        <span class="stat-label">Live Viewers</span>
                    </div>
                ` : ''}
            </div>
            <div class="profile-specialties">
                <h4>Specialties:</h4>
                ${creator.specialties.map(s => `<span class="specialty-tag">${s}</span>`).join('')}
            </div>
            ${creator.toyConnected ? `
                <div class="toy-info">
                    <h4>üéÆ Connected Toy:</h4>
                    <p>${creator.toyConnected}</p>
                </div>
            ` : ''}
            <div class="profile-actions">
                <button class="btn btn--primary" onclick="openTipModal('${creator.username}')">üí∏ Send Tip</button>
                <button class="btn btn--outline" onclick="openPrivateMessage('${creator.username}')">üí¨ Message</button>
                ${creator.status === 'online' ? `
                    <button class="btn btn--outline" onclick="initiateCall('${creator.username}', 'video')">üìπ Video Call</button>
                ` : ''}
            </div>
        </div>
    `);
}

function openPrivateMessage(username) {
    showSuccessModal(
        'üí¨ Message System',
        `Private messaging with ${username} is available for premium members!\n\nUpgrade to VIP to unlock unlimited messaging.`
    );
}

function showAchievementDetails(trophy) {
    const title = trophy.querySelector('h4').textContent;
    const description = trophy.querySelector('p').textContent;
    
    createCustomModal(`üèÜ ${title}`, `
        <div class="achievement-details">
            <div class="achievement-icon">${trophy.querySelector('.trophy-model').textContent}</div>
            <p>${description}</p>
            <div class="achievement-rewards">
                <h4>Rewards Unlocked:</h4>
                <ul>
                    <li>üíé 500 bonus tokens</li>
                    <li>‚≠ê Exclusive badge</li>
                    <li>üé® Custom emoji set</li>
                </ul>
            </div>
            <div class="achievement-date">
                <small>Earned on: ${new Date().toLocaleDateString()}</small>
            </div>
        </div>
    `);
}

function showLockedAchievement(trophy) {
    const title = trophy.querySelector('h4').textContent;
    
    createCustomModal(`üîí ${title}`, `
        <div class="locked-achievement">
            <div class="locked-icon">üîí</div>
            <p>This achievement is still locked.</p>
            <div class="unlock-requirements">
                <h4>Requirements:</h4>
                <ul>
                    <li>üìà Reach $10K total earnings</li>
                    <li>‚≠ê Maintain 5-star rating</li>
                    <li>üë• Gain 5K+ subscribers</li>
                </ul>
            </div>
            <p class="encouragement">Keep creating amazing content to unlock this achievement! üí™</p>
        </div>
    `);
}

function createCustomModal(title, content) {
    const modal = document.createElement('div');
    modal.className = 'modal active';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h3>${title}</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                ${content}
            </div>
        </div>
    `;
    
    modal.querySelector('.modal-close').addEventListener('click', () => {
        modal.remove();
    });
    
    modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.remove();
    });
    
    document.body.appendChild(modal);
    return modal;
}

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        document.querySelectorAll('.modal.active').forEach(modal => {
            modal.classList.remove('active');
        });
    }
    
    // Quick navigation shortcuts
    if (e.altKey) {
        switch(e.key) {
            case '1': switchToTab('explore'); break;
            case '2': switchToTab('creators'); break;
            case '3': switchToTab('content'); break;
            case '4': switchToTab('calls'); break;
            case '5': switchToTab('tokens'); break;
            case '6': switchToTab('groups'); break;
            case '7': switchToTab('dashboard'); break;
        }
    }
});

function switchToTab(tabName) {
    const tab = document.querySelector(`[data-tab="${tabName}"]`);
    if (tab) {
        tab.click();
    }
}